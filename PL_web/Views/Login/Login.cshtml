@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}

<h2>Login</h2>

<input type="text" id="txtEmail" placeholder="Email" class="form-control mb-2"/>
<input type="password" id="txtContrasena" placeholder="Contraseña" class="form-control mb-2"/>

<button id="btnLogin" class="btn btn-success">Iniciar Sesión</button>

<script>
    $(document).ready(function () {
        $("#btnLogin").click(function () {
            var email = $("#txtEmail").val();
            var contrasena = $("#txtContrasena").val();

            $.ajax({
                url: "/Login/AutenticarUsuario",
                type: "POST",
                data: { email: email, contrasena: contrasena },
                success: function (response) {
                    if (response.success) {
                        // Guardar el token en una cookie
                        document.cookie = "jwtToken=" + response.token + "; path=/";

                        alert("Sesión iniciada con éxito");

                        // Redirigir a alguna vista protegida
                        window.location.href = "/Usuario/GetAll";
                    } else {
                        alert("Credenciales incorrectas");
                    }
                },
                error: function () {
                    alert("Error al conectar con el servidor.");
                }
            });
        });
    });
</script>